Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<eigenfaces-algorithm.m\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.67058897489854*^9, 3.6705890135036297`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeGrid", "[", 
   RowBox[{"trainingData_", ",", "testData_", ",", "numEF_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"neutralFaces", "=", 
      RowBox[{"trainingData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"normalizedFaces", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "-", 
          RowBox[{"Mean", "[", "#", "]"}]}], "&"}], ",", " ", 
        RowBox[{"Flatten", "/@", 
         RowBox[{"trainingData", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eigenvalues", ",", " ", "eigenfaces"}], "}"}], "=", 
      RowBox[{"findEigenfaces", "[", "normalizedFaces", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"trainingFaces", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"eigenCompress", "[", 
          RowBox[{"#", ",", "eigenfaces", ",", "numEF"}], "]"}], "&"}], ",", 
        "normalizedFaces"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Grid", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Image", "[", 
             RowBox[{"face", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\"\<\[Rule]\>\""}],
            "}"}], ",", 
          RowBox[{
           RowBox[{"matches", "=", 
            RowBox[{
             RowBox[{"recognizeFace", "[", 
              RowBox[{
               RowBox[{"face", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "numEF", ",", "1"}], 
              "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", 
           RowBox[{"trainingData", "[", 
            RowBox[{"[", 
             RowBox[{"matches", ",", "2"}], "]"}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"face", ",", "testData"}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6705894088917723`*^9, 3.670589420660891*^9}, {
  3.670589552234806*^9, 3.670589612977295*^9}, {3.670589647301201*^9, 
  3.6705896497688*^9}, {3.670589708650105*^9, 3.6705897405054817`*^9}, {
  3.670770053141712*^9, 3.670770072376089*^9}, {3.670776475373046*^9, 
  3.67077649872338*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FOM", "[", 
   RowBox[{"trainingData_", ",", "testData_", ",", 
    RowBox[{"numEF_", "/;", 
     RowBox[{"NumberQ", "[", "numEF", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FOM", "[", 
      RowBox[{"trainingData", ",", "testData", ",", 
       RowBox[{"{", 
        RowBox[{"numEF", ",", "numEF"}], "}"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6707701107191973`*^9, 3.6707701978144827`*^9}, {
   3.6707704865568013`*^9, 3.6707705076717014`*^9}, {3.6707705792736015`*^9, 
   3.670770581642401*^9}, {3.670770640824901*^9, 3.6707706467920012`*^9}, {
   3.6707706847777014`*^9, 3.6707706873756013`*^9}, 3.6707707514833612`*^9, {
   3.670771189088091*^9, 3.6707711921758723`*^9}, {3.670771951428216*^9, 
   3.670771991461516*^9}, {3.670772021486516*^9, 3.670772044062916*^9}, {
   3.670772123415516*^9, 3.6707721550956163`*^9}, {3.670772219125516*^9, 
   3.670772219252816*^9}, {3.670772576364416*^9, 3.6707725923149157`*^9}, {
   3.6707755435586753`*^9, 3.6707756391599627`*^9}, {3.67077572640427*^9, 
   3.6707757479527807`*^9}, {3.670776207942305*^9, 3.6707762985853686`*^9}, {
   3.6707763395214615`*^9, 3.6707763565491643`*^9}, {3.6707766686853747`*^9, 
   3.6707766711836247`*^9}, 3.6707770819026923`*^9, {3.670837914588038*^9, 
   3.670837947932942*^9}, {3.670838649630664*^9, 3.6708386663870087`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FOM", "[", 
   RowBox[{"trainingData_", ",", "testData_", ",", 
    RowBox[{"{", 
     RowBox[{"numEFmin_", ",", "numEFmax_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"FOM", "[", 
     RowBox[{"trainingData", ",", "trainingData", ",", "testData", ",", 
      RowBox[{"{", 
       RowBox[{"numEFmin", ",", "numEFmax"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6708400691364527`*^9, 3.670840144158123*^9}, {
  3.67084026937138*^9, 3.67084029475629*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FOM", "[", 
   RowBox[{
   "trainingData_List", ",", "eigenTraining_List", ",", "testData_List", ",", 
    
    RowBox[{"{", 
     RowBox[{"numEFmin_", ",", "numEFmax_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "allTrainingFaces", ",", "successpercent", ",", "successpercents"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"neutralFaces", "=", 
      RowBox[{"eigenTraining", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"normalizedFaces", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "-", 
          RowBox[{"Mean", "[", "#", "]"}]}], "&"}], ",", " ", 
        RowBox[{"Flatten", "/@", 
         RowBox[{"eigenTraining", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eigenvalues", ",", " ", "eigenfaces"}], "}"}], "=", 
      RowBox[{"findEigenfaces", "[", "normalizedFaces", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Switch", " ", "to", " ", "using", " ", "full", " ", "training", " ", 
       "data"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"normalizedFaces", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "-", 
          RowBox[{"Mean", "[", "#", "]"}]}], "&"}], ",", " ", 
        RowBox[{"Flatten", "/@", 
         RowBox[{"trainingData", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"allTrainingFaces", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"eigenCompress", "[", 
          RowBox[{"#", ",", "eigenfaces", ",", "numEFmax"}], "]"}], "&"}], 
        ",", "normalizedFaces"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Compute", " ", "the", " ", "success", " ", "percentages", " ", "for", 
       " ", "each", " ", "numEF"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"successpercents", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"trainingFaces", "=", 
          RowBox[{"allTrainingFaces", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"1", ";;", "numEF"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"matchesFound", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"face", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"trainingData", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"recognizeFace", "[", 
                   RowBox[{
                    RowBox[{"face", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "numEF", ",", "1"}], 
                   "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"face", ",", "testData"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"successpercent", "=", 
          FractionBox[
           RowBox[{"Length", "@", 
            RowBox[{"Cases", "[", 
             RowBox[{"matchesFound", ",", 
              RowBox[{"{", 
               RowBox[{"x_", ",", "x_"}], "}"}]}], "]"}]}], 
           RowBox[{"Length", "@", "matchesFound"}]]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"numEF", ",", "numEFmin", ",", "numEFmax"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "successpercents", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6707701107191973`*^9, 3.6707701978144827`*^9}, {
   3.6707704865568013`*^9, 3.6707705076717014`*^9}, {3.6707705792736015`*^9, 
   3.670770581642401*^9}, {3.670770640824901*^9, 3.6707706467920012`*^9}, {
   3.6707706847777014`*^9, 3.6707706873756013`*^9}, 3.6707707514833612`*^9, {
   3.670771189088091*^9, 3.6707711921758723`*^9}, {3.670771951428216*^9, 
   3.670771991461516*^9}, {3.670772021486516*^9, 3.670772044062916*^9}, {
   3.670772123415516*^9, 3.6707721550956163`*^9}, {3.670772219125516*^9, 
   3.670772219252816*^9}, {3.670772576364416*^9, 3.6707725923149157`*^9}, {
   3.6707755435586753`*^9, 3.6707756391599627`*^9}, {3.67077572640427*^9, 
   3.6707757479527807`*^9}, {3.670776207942305*^9, 3.6707762985853686`*^9}, {
   3.6707763395214615`*^9, 3.6707763565491643`*^9}, {3.6707766686853747`*^9, 
   3.6707766711836247`*^9}, 3.6707770819026923`*^9, {3.670837888870792*^9, 
   3.670837907468636*^9}, {3.670837960858905*^9, 3.670837993072959*^9}, {
   3.670838076731545*^9, 3.6708381367842913`*^9}, {3.670838193699369*^9, 
   3.6708382115666847`*^9}, 3.670838500093226*^9, {3.670838550586545*^9, 
   3.670838591859991*^9}, {3.67084012019273*^9, 3.6708401315909443`*^9}, {
   3.6708401872764473`*^9, 3.6708402642610493`*^9}, {3.67084052575457*^9, 
   3.670840528031805*^9}, {3.6708405633190613`*^9, 3.6708405760176983`*^9}, {
   3.6709280929537687`*^9, 3.6709282191808643`*^9}, {3.6709283799895277`*^9, 
   3.670928481157156*^9}, {3.670928526939719*^9, 3.670928531255352*^9}, {
   3.670928769768759*^9, 3.6709287764849663`*^9}, {3.67092884087396*^9, 
   3.670928915365528*^9}, {3.670929053027841*^9, 3.670929244048531*^9}, 
   3.67092930285535*^9, 3.670933169902684*^9}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{"i", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "10", ",", "5", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670838058679516*^9, 3.6708380689181004`*^9}}],

Cell[CellGroupData[{

Cell["Neutral faces training", "Title",
 CellChangeTimes->{{3.6705889377626543`*^9, 3.670588949453114*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"labelledFaces", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Labeled", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"images", ",", 
       RowBox[{"Catenate", "@", 
        RowBox[{"Transpose", "@", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"names", ",", "8"}], "]"}]}]}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6707715087276163`*^9, 3.6707716291478157`*^9}, {
  3.670771866447516*^9, 3.670771869746716*^9}, {3.6707724289315157`*^9, 
  3.670772435527516*^9}}],

Cell[CellGroupData[{

Cell["Train on 43, test on 301 (sampled)", "Chapter",
 CellChangeTimes->{{3.670589377324398*^9, 3.670589395756258*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"training", "=", 
   RowBox[{"labelledFaces", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "344", ";;", "8"}], "]"}], "]"}]}], ";", 
  RowBox[{"testing", "=", 
   RowBox[{"labelledFaces", "[", 
    RowBox[{"[", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Range", "[", "344", "]"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", "344", ",", "8"}], "]"}]}], "]"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6708390491141567`*^9, 3.670839072090308*^9}, {
  3.670839129471631*^9, 3.67083913036814*^9}, {3.670839320554762*^9, 
  3.670839329354158*^9}, {3.6708394639276333`*^9, 3.6708394781392393`*^9}, {
  3.670839517686037*^9, 3.670839521345202*^9}, {3.670839563937996*^9, 
  3.67083957394545*^9}, {3.670933370530304*^9, 3.670933370756988*^9}, {
  3.670939233368685*^9, 3.670939252776497*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FOM", "[", 
      RowBox[{"training", ",", 
       RowBox[{"testing", "[", 
        RowBox[{"[", 
         RowBox[{"s", ";;", "All", ";;", "7"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "43"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "1", ",", "7"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "@", "data"}]}], "Input",
 CellChangeTimes->{{3.6707797868589587`*^9, 3.6707798480053587`*^9}, {
  3.670780560379841*^9, 3.6707805604422407`*^9}, {3.670838702156506*^9, 
  3.670838708868198*^9}, {3.670839589430483*^9, 3.6708396169945927`*^9}, {
  3.670839650215129*^9, 3.6708396514594793`*^9}}],

Cell[BoxData[{
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"data", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "All"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"emotions", "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;", "8"}], "]"}], "]"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Number of Eigenfaces\>\"", ",", "\"\<Recognition accuracy\>\""}], 
     "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"\"\<Training on \>\"", "<>", 
     RowBox[{"ToString", "@", 
      RowBox[{"Length", "@", "training"}]}], "<>", 
     "\"\< faces, tested on \>\"", "<>", 
     RowBox[{"ToString", "@", 
      RowBox[{"Length", "@", "testing"}]}]}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<fewtrain.png\>\"", ",", "%"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6707787420548162`*^9, 3.6707788598248167`*^9}, {
   3.6707789825504813`*^9, 3.670778983925619*^9}, {3.6707791719259644`*^9, 
   3.6707792351894627`*^9}, {3.6707792893413005`*^9, 
   3.6707792894504986`*^9}, {3.670779371740468*^9, 3.670779433207085*^9}, 
   3.6707798068443584`*^9, {3.670779854727759*^9, 3.6707798952276883`*^9}, {
   3.670779930453145*^9, 3.6707799309523478`*^9}, {3.6707802358163977`*^9, 
   3.6707802607383533`*^9}, {3.6707802914993763`*^9, 3.670780366688639*^9}, {
   3.670780642072217*^9, 3.6707806655812173`*^9}, 3.670839548057777*^9, {
   3.67093396146594*^9, 3.670933985648954*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Train on 301, test on 43 (sampled)", "Chapter",
 CellChangeTimes->{{3.670589377324398*^9, 3.670589395756258*^9}, {
  3.670838916357644*^9, 3.670838920074368*^9}}],

Cell[BoxData[
 RowBox[{"Length", "@", "images"}]], "Input",
 CellChangeTimes->{{3.670838959639532*^9, 3.670838963751527*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"training2", "=", 
   RowBox[{"labelledFaces", "[", 
    RowBox[{"[", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Range", "[", "344", "]"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"7", ",", "344", ",", "8"}], "]"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testing2", "=", 
   RowBox[{"labelledFaces", "[", 
    RowBox[{"[", 
     RowBox[{"7", ";;", "344", ";;", "8"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6708390491141567`*^9, 3.670839072090308*^9}, {
  3.670839129471631*^9, 3.67083913036814*^9}, {3.670839320554762*^9, 
  3.670839329354158*^9}, {3.6708394639276333`*^9, 3.6708394781392393`*^9}, {
  3.670839517686037*^9, 3.670839521345202*^9}, {3.670839689914295*^9, 
  3.670839691909748*^9}, {3.670840448062263*^9, 3.670840448255989*^9}, {
  3.670840638535527*^9, 3.67084064041684*^9}, {3.670939063148806*^9, 
  3.670939066567572*^9}, {3.670939261374703*^9, 3.67093926537217*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data2", "=", 
   RowBox[{"FOM", "[", 
    RowBox[{"training", ",", "training2", ",", "testing2", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "301"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "@", "data2"}]}], "Input",
 CellChangeTimes->{{3.6707797868589587`*^9, 3.6707798480053587`*^9}, {
  3.670780560379841*^9, 3.6707805604422407`*^9}, {3.670838702156506*^9, 
  3.670838708868198*^9}, {3.670838931462111*^9, 3.6708389907784023`*^9}, {
  3.670839059853138*^9, 3.670839074132462*^9}, {3.670839107274238*^9, 
  3.670839137735215*^9}, {3.6708393466023417`*^9, 3.670839346665501*^9}, {
  3.670839499893498*^9, 3.670839523438138*^9}, {3.670839626705709*^9, 
  3.670839628170969*^9}, {3.670839693182045*^9, 3.6708396952395*^9}, {
  3.670840312295383*^9, 3.670840313652246*^9}, {3.670840602213441*^9, 
  3.6708406037811937`*^9}, {3.6709401891739197`*^9, 3.67094018939608*^9}}],

Cell[BoxData[{
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"data2", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "All"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Number of Eigenfaces\>\"", ",", "\"\<Recognition accuracy\>\""}], 
     "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"\"\<Training on \>\"", "<>", 
     RowBox[{"ToString", "@", 
      RowBox[{"Length", "@", "training2"}]}], "<>", 
     "\"\< faces, tested on \>\"", "<>", 
     RowBox[{"ToString", "@", 
      RowBox[{"Length", "@", "testing2"}]}]}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<manytrain.png\>\"", ",", "%"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6707787420548162`*^9, 3.6707788598248167`*^9}, {
   3.6707789825504813`*^9, 3.670778983925619*^9}, {3.6707791719259644`*^9, 
   3.6707792351894627`*^9}, {3.6707792893413005`*^9, 
   3.6707792894504986`*^9}, {3.670779371740468*^9, 3.670779433207085*^9}, 
   3.6707798068443584`*^9, {3.670779854727759*^9, 3.6707798952276883`*^9}, {
   3.670779930453145*^9, 3.6707799309523478`*^9}, {3.6707802358163977`*^9, 
   3.6707802607383533`*^9}, {3.6707802914993763`*^9, 3.670780366688639*^9}, {
   3.670780642072217*^9, 3.6707806655812173`*^9}, {3.670839001669969*^9, 
   3.670839015524508*^9}, {3.670839297759893*^9, 3.670839300339219*^9}, {
   3.670839369273238*^9, 3.670839443220316*^9}, 3.6708396302229357`*^9, {
   3.670839729509203*^9, 3.670839731303315*^9}, {3.67093399316385*^9, 
   3.670933998241097*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<manytrain.png\>\"", ",", 
    RowBox[{"Out", "[", "153", "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.670934018666525*^9, 3.670934020948194*^9}}],

Cell[BoxData[
 RowBox[{"makeGrid", "[", 
  RowBox[{"training2", ",", "testing2", ",", "All"}], "]"}]], "Input",
 CellChangeTimes->{{3.670776503697878*^9, 3.670776525216029*^9}, 
   3.670776636389146*^9, {3.670839229673558*^9, 3.670839234060244*^9}, {
   3.6708407685743923`*^9, 3.670840769864592*^9}}],

Cell[BoxData["emotions"], "Input",
 CellChangeTimes->{{3.6708407888921432`*^9, 3.670840789774371*^9}}],

Cell[CellGroupData[{

Cell["Work with fewer people", "Section",
 CellChangeTimes->{{3.670589377324398*^9, 3.670589395756258*^9}, {
  3.670838916357644*^9, 3.670838920074368*^9}, {3.670841037351713*^9, 
  3.6708410400974092`*^9}}],

Cell[BoxData[
 RowBox[{"Length", "@", "images"}]], "Input",
 CellChangeTimes->{{3.670838959639532*^9, 3.670838963751527*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"training3", "=", 
   RowBox[{"labelledFaces", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "40", ";;", "8"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testing3", "=", 
   RowBox[{"labelledFaces", "[", 
    RowBox[{"[", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Range", "[", "40", "]"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"40", ",", "8"}], "]"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"training4", "=", 
   RowBox[{"labelledFaces", "[", 
    RowBox[{"[", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Range", "[", "40", "]"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"3", ",", "40", ",", "8"}], "]"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testing4", "=", 
   RowBox[{"labelledFaces", "[", 
    RowBox[{"[", 
     RowBox[{"3", ";;", "40", ";;", "8"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6708390491141567`*^9, 3.670839072090308*^9}, {
  3.670839129471631*^9, 3.67083913036814*^9}, {3.670839320554762*^9, 
  3.670839329354158*^9}, {3.6708394639276333`*^9, 3.6708394781392393`*^9}, {
  3.670839517686037*^9, 3.670839521345202*^9}, {3.670839689914295*^9, 
  3.670839691909748*^9}, {3.670840448062263*^9, 3.670840448255989*^9}, {
  3.670840638535527*^9, 3.67084064041684*^9}, {3.670841327819887*^9, 
  3.670841432259158*^9}}],

Cell[CellGroupData[{

Cell["Train on few", "Subsection",
 CellChangeTimes->{{3.6708414424060097`*^9, 3.6708414442382927`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data3", "=", 
   RowBox[{"FOM", "[", 
    RowBox[{"training3", ",", "training3", ",", "testing3", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "@", "data3"}]}], "Input",
 CellChangeTimes->{{3.6707797868589587`*^9, 3.6707798480053587`*^9}, {
  3.670780560379841*^9, 3.6707805604422407`*^9}, {3.670838702156506*^9, 
  3.670838708868198*^9}, {3.670838931462111*^9, 3.6708389907784023`*^9}, {
  3.670839059853138*^9, 3.670839074132462*^9}, {3.670839107274238*^9, 
  3.670839137735215*^9}, {3.6708393466023417`*^9, 3.670839346665501*^9}, {
  3.670839499893498*^9, 3.670839523438138*^9}, {3.670839626705709*^9, 
  3.670839628170969*^9}, {3.670839693182045*^9, 3.6708396952395*^9}, {
  3.670840312295383*^9, 3.670840313652246*^9}, {3.670840602213441*^9, 
  3.6708406037811937`*^9}, {3.670841356280426*^9, 3.670841380527554*^9}, {
  3.670841437471472*^9, 3.6708414633089457`*^9}}],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"data3", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "All"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Number of Eigenfaces\>\"", ",", "\"\<Recognition accuracy\>\""}], 
     "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"\"\<Training on \>\"", "<>", 
     RowBox[{"ToString", "@", 
      RowBox[{"Length", "@", "training3"}]}], "<>", 
     "\"\< faces, tested on \>\"", "<>", 
     RowBox[{"ToString", "@", 
      RowBox[{"Length", "@", "testing3"}]}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6707787420548162`*^9, 3.6707788598248167`*^9}, {
   3.6707789825504813`*^9, 3.670778983925619*^9}, {3.6707791719259644`*^9, 
   3.6707792351894627`*^9}, {3.6707792893413005`*^9, 
   3.6707792894504986`*^9}, {3.670779371740468*^9, 3.670779433207085*^9}, 
   3.6707798068443584`*^9, {3.670779854727759*^9, 3.6707798952276883`*^9}, {
   3.670779930453145*^9, 3.6707799309523478`*^9}, {3.6707802358163977`*^9, 
   3.6707802607383533`*^9}, {3.6707802914993763`*^9, 3.670780366688639*^9}, {
   3.670780642072217*^9, 3.6707806655812173`*^9}, {3.670839001669969*^9, 
   3.670839015524508*^9}, {3.670839297759893*^9, 3.670839300339219*^9}, {
   3.670839369273238*^9, 3.670839443220316*^9}, 3.6708396302229357`*^9, {
   3.670839729509203*^9, 3.670839731303315*^9}, {3.6708420003532543`*^9, 
   3.670842001650015*^9}, 3.6708420903241377`*^9}],

Cell[BoxData[
 RowBox[{"makeGrid", "[", 
  RowBox[{"training2", ",", "testing2", ",", "All"}], "]"}]], "Input",
 CellChangeTimes->{{3.670776503697878*^9, 3.670776525216029*^9}, 
   3.670776636389146*^9, {3.670839229673558*^9, 3.670839234060244*^9}, {
   3.6708407685743923`*^9, 3.670840769864592*^9}}],

Cell[BoxData["emotions"], "Input",
 CellChangeTimes->{{3.6708407888921432`*^9, 3.670840789774371*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Train on many", "Subsection",
 CellChangeTimes->{{3.6708414424060097`*^9, 3.6708414442382927`*^9}, {
  3.6708455865063066`*^9, 3.670845586877248*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data3", "=", 
   RowBox[{"FOM", "[", 
    RowBox[{"training3", ",", "training4", ",", "testing4", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "@", "data3"}]}], "Input",
 CellChangeTimes->{{3.6707797868589587`*^9, 3.6707798480053587`*^9}, {
  3.670780560379841*^9, 3.6707805604422407`*^9}, {3.670838702156506*^9, 
  3.670838708868198*^9}, {3.670838931462111*^9, 3.6708389907784023`*^9}, {
  3.670839059853138*^9, 3.670839074132462*^9}, {3.670839107274238*^9, 
  3.670839137735215*^9}, {3.6708393466023417`*^9, 3.670839346665501*^9}, {
  3.670839499893498*^9, 3.670839523438138*^9}, {3.670839626705709*^9, 
  3.670839628170969*^9}, {3.670839693182045*^9, 3.6708396952395*^9}, {
  3.670840312295383*^9, 3.670840313652246*^9}, {3.670840602213441*^9, 
  3.6708406037811937`*^9}, {3.670841356280426*^9, 3.670841380527554*^9}, {
  3.670841437471472*^9, 3.6708414633089457`*^9}, {3.6708455968574743`*^9, 
  3.6708456010669537`*^9}}],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"data3", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "All"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Number of Eigenfaces\>\"", ",", "\"\<Recognition accuracy\>\""}], 
     "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"\"\<Training on \>\"", "<>", 
     RowBox[{"ToString", "@", 
      RowBox[{"Length", "@", "training3"}]}], "<>", 
     "\"\< faces, tested on \>\"", "<>", 
     RowBox[{"ToString", "@", 
      RowBox[{"Length", "@", "testing3"}]}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6707787420548162`*^9, 3.6707788598248167`*^9}, {
   3.6707789825504813`*^9, 3.670778983925619*^9}, {3.6707791719259644`*^9, 
   3.6707792351894627`*^9}, {3.6707792893413005`*^9, 
   3.6707792894504986`*^9}, {3.670779371740468*^9, 3.670779433207085*^9}, 
   3.6707798068443584`*^9, {3.670779854727759*^9, 3.6707798952276883`*^9}, {
   3.670779930453145*^9, 3.6707799309523478`*^9}, {3.6707802358163977`*^9, 
   3.6707802607383533`*^9}, {3.6707802914993763`*^9, 3.670780366688639*^9}, {
   3.670780642072217*^9, 3.6707806655812173`*^9}, {3.670839001669969*^9, 
   3.670839015524508*^9}, {3.670839297759893*^9, 3.670839300339219*^9}, {
   3.670839369273238*^9, 3.670839443220316*^9}, 3.6708396302229357`*^9, {
   3.670839729509203*^9, 3.670839731303315*^9}, {3.6708420003532543`*^9, 
   3.670842001650015*^9}, 3.6708420903241377`*^9}],

Cell[BoxData[
 RowBox[{"makeGrid", "[", 
  RowBox[{"training2", ",", "testing2", ",", "All"}], "]"}]], "Input",
 CellChangeTimes->{{3.670776503697878*^9, 3.670776525216029*^9}, 
   3.670776636389146*^9, {3.670839229673558*^9, 3.670839234060244*^9}, {
   3.6708407685743923`*^9, 3.670840769864592*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Misc", "Section",
 CellChangeTimes->{{3.670939091612404*^9, 3.67093909207591*^9}}],

Cell[BoxData["emotions"], "Input",
 CellChangeTimes->{{3.6708407888921432`*^9, 3.670840789774371*^9}}],

Cell[BoxData["data"], "Input",
 CellChangeTimes->{{3.670938828399132*^9, 3.67093883907098*^9}}],

Cell[BoxData[{
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"data", "[", 
      RowBox[{"[", "7", "]"}], "]"}], ",", "data2"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Few training\>\"", ",", "\"\<Many training\>\""}], 
     "}"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<fewmanycomparedisgust.png\>\"", ",", "%"}], "]"}]}], "Input",
 CellChangeTimes->{{3.670938960931169*^9, 3.670939027623439*^9}, {
  3.670939176425515*^9, 3.670939188403283*^9}, {3.670939272321147*^9, 
  3.670939283300988*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1261, 1013},
WindowMargins->{{Automatic, 222}, {Automatic, -8}},
Magnification:>1.5 Inherited,
FrontEndVersion->"10.3 for Linux x86 (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
